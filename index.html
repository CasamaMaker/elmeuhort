<!-- <!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <title>La meva PWA</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2b2b2b">
  <link rel="icon" href="./favicon.ico" type="image/x-icon">
</head>
<body>
  <h1>Funciona GitHub Pages</h1>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./service-worker.js');
  }
  </script>
</body>
</html> -->



<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <link rel="manifest" href="manifest.json">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="./favicon.ico" type="image/x-icon">
  <title>el Meu Hort</title>
  <style>
      body {
          font-family: Arial, sans-serif;
          margin: 0;
          padding: 0;
          background: #f4f4f4;
      }

      .tabs {
          display: flex;
          flex-wrap: wrap;
          background: #2c3e50;
      }

      .tabs button {
          flex: 1 0 14.28%;
          padding: 10px;
          background: #34495e;
          color: white;
          border: none;
          cursor: pointer;
          transition: background 0.3s;
      }

      .tabs button:hover {
          background: #1abc9c;
      }

      .tabs button.active {
          background: #1abc9c;
      }

      .tab-content {
          padding: 20px;
          background: white;
          min-height: 200px;
      }
  </style>
</head>
<body>

<div class="tabs" id="tabs">
    <!-- Botons dels mesos es generaran automàticament -->
</div>

<div id="tab-contents">
    <!-- Contingut dels mesos es generarà automàticament -->
</div>

<script>
const SHEET_ID = "1VmQdVqhokSYiHTfNNg7z4v4fLPePhAD53za76YBJnhg";
const SHEET_NAME = "Full1"; // nom de la fulla del Google Sheet
const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${SHEET_NAME}&tq=&tqx=out:json`;

let mesos = ["Gener","Febrer","Març","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"];

fetch(URL)
  .then(res => res.text())
  .then(data => {
    // El Google Sheets JSON ve envoltat de text
    const json = JSON.parse(data.substring(47, data.length-2));
    const rows = json.table.rows.map(r => r.c.map(c => c ? c.v : ""));

    // Generar els botons dels mesos
    const tabsDiv = document.getElementById("tabs");
    mesos.forEach((mes, idx) => {
        const btn = document.createElement("button");
        btn.className = "tab-link";
        if(idx===0) btn.classList.add("active");
        btn.innerText = mes;
        btn.onclick = (e) => openMonth(e, mes);
        tabsDiv.appendChild(btn);
    });

    // Generar el contingut dels mesos
    const contentDiv = document.getElementById("tab-contents");
    mesos.forEach((mes, idx) => {
        const div = document.createElement("div");
        div.id = mes;
        div.className = "tab-content";
        if(idx!==0) div.style.display = "none";
        const cultius = rows.filter(r => r[1] === mes).map(r => r[0]);
        div.innerHTML = `<h2>${mes}</h2><p>Cultius: ${cultius.join(", ")}</p>`;
        contentDiv.appendChild(div);
    });
  })
  .catch(err => console.error("Error carregant Google Sheet:", err));

function openMonth(evt, monthName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tab-content");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tab-link");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].classList.remove("active");
    }
    document.getElementById(monthName).style.display = "block";
    evt.currentTarget.classList.add("active");
}
</script>

</body>
</html>
